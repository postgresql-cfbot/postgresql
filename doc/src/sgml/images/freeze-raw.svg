<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg xmlns="http://www.w3.org/2000/svg"
     xmlns:xlink="http://www.w3.org/1999/xlink"
     version="1.1"
     width="850px" height="320px"
     viewBox="0 0 850 320" >

  <title>Freeze</title>

  <!-- common text classes -->
  <style type="text/css">
  .text_normal  {font-style:normal;
                 font-weight:normal;
                 font-size:14px;
                 font-family:"Open Sans", sans-serif;
                 fill:black;
                }
  .text_big     {font-style:normal;
                 font-weight:normal;
                 font-size:24px;
                 font-family:"Open Sans", sans-serif, Helvetica;
                 fill:black;
                }
  </style>

  <defs>
    <!-- SVG 1.x supports <texPath> only in combination with <path>. SVG 2 allows it with
         every shape element, especially with <circle>. As of 2020 we must restrict ourselves
         to SVG 1. Therefore we simulate a circle by defining two arcs, each of them is
         a half-circle.
    -->
    <path id="Path_080" d="m -80 0
                           a 80 80 0 1 1  160 0
                           a 80 80 0 1 1 -160 0"/>
    <path id="Path_095" d="m -95 0
                           a 95 95 0 1 1  190 0
                           a 95 95 0 1 1 -190 0"/>
    <path id="Path_120" d="m -120 0
                           a 120 120 0 1 1  240 0
                           a 120 120 0 1 1 -240 0"/>

    <!-- split transform="translate(x y) rotate(arc)" into two steps for clarity -->
    <circle id="frozenPoint"   r="3" stroke="green" fill="green" transform="translate(-100, 0)"/>
    <circle id="unfrozenPoint" r="3" stroke="green" fill="none"  transform="translate(-100, 0)"/>

  </defs>


  <!-- start of rendering area -->
  <!-- enclosing rectangle -->
  <rect x="1" y="1" rx="5" width="99%" height="99%" stroke="black" fill="none" />
  <text class="text_big" x="70" y="40"><tspan style="font-style:italic;font-weight:bold">
        Freeze</tspan> to keep visible</text>

  <!-- set default values -->
  <g fill="none" transform="translate(170 190)">

    <circle r="100" stroke="blue" />

    <text class="text_normal">
      <textPath xlink:href="#Path_095" startOffset="0.5%" >|</textPath>
      <textPath xlink:href="#Path_120" startOffset="00%" >(0)</textPath>
      <textPath xlink:href="#Path_080" startOffset="01%" stroke="blue" stroke-width="0.5px" >
        - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - ></textPath>
      <textPath xlink:href="#Path_120" startOffset="11.2%" >(1)</textPath>
      <textPath xlink:href="#Path_120" startOffset="61.2%" >(5)</textPath>

      <textPath xlink:href="#Path_095" stroke="red" stroke-width="3" startOffset="34%" >|</textPath>
      <textPath xlink:href="#Path_120" startOffset="34%" >(2)</textPath>

      <textPath xlink:href="#Path_095" stroke="black" stroke-width="3" startOffset="45%" >|</textPath>
      <textPath xlink:href="#Path_120" startOffset="45%" >(3)</textPath>

      <textPath xlink:href="#Path_095" stroke="green" stroke-width="3" startOffset="55%" >|</textPath>
      <textPath xlink:href="#Path_120" startOffset="55%" >(4)</textPath>

    </text>

    <!-- split it into 'past' and 'future' -->
    <path d="M -80 -80 l 160 160" stroke="black" />
    <text class="text_normal" letter-spacing="12" transform="translate(-15, -40) rotate(45)">PAST</text>
    <text class="text_normal" letter-spacing="12" transform="translate(30, 60) rotate(225)">FUTURE</text>

    <g transform="rotate(10)"><use xlink:href="#frozenPoint"/></g>
    <g transform="rotate(25)"><use xlink:href="#frozenPoint"/></g>
    <g transform="rotate(40)"><use xlink:href="#frozenPoint"/></g>
    <g transform="rotate(55)"><use xlink:href="#frozenPoint"/></g>
    <g transform="rotate(70)"><use xlink:href="#frozenPoint"/></g>
    <g transform="rotate(85)"><use xlink:href="#frozenPoint"/></g>
    <g transform="rotate(100)"><use xlink:href="#frozenPoint"/></g>
    <g transform="rotate(115)"><use xlink:href="#frozenPoint"/></g>
    <g transform="rotate(130)"><use xlink:href="#frozenPoint"/></g>
    <g transform="rotate(145)"><use xlink:href="#unfrozenPoint"/></g>
    <g transform="rotate(160)"><use xlink:href="#frozenPoint"/></g>
    <g transform="rotate(175)"><use xlink:href="#frozenPoint"/></g>
    <g transform="rotate(190)"><use xlink:href="#unfrozenPoint"/></g>
    <g transform="rotate(205)"><use xlink:href="#unfrozenPoint"/></g>
    <g transform="rotate(220)"><use xlink:href="#unfrozenPoint"/></g>

  </g>

  <!-- legend -->
  <g class="text_normal" transform="translate(380 30)">
    <text>0: 0 .. 2  <tspan dy="-5">^</tspan> <tspan dy="5">32</tspan> - 1</text>
    <text y="25">1: txid_current + 2 ^ 31 (split-point)</text>
    <text y="50">2: autovacuum_freeze_max_age (200 mio.)</text>
    <text y="75">3: vacuum_freeze_table_age (150 mio.)</text>
    <text y="100">4: vacuum_freeze_min_age (50 mio.)</text>
    <text y="125">5: txid_current (split-point, youngest xid)</text>
    <text y="155">per table: pg_class.relfrozenxid
          <tspan style="font-weight:bold">must</tspan> be between (1) and (5);</text>
    <text y="175" x="75">normally it is between (3) and (4)</text>

    <use xlink:href="#unfrozenPoint" transform="translate(106, 200)"/>
    <text y="205" x="20">Unfrozen xid</text>

    <use xlink:href="#frozenPoint" transform="translate(106, 224)"/>
    <text y="230" x="20">Frozen xid</text>

    <text y="260">(figure is out of scale)</text>
  </g>

</svg>
